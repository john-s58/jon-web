{% extends "base.html" %}

{% block title %}Resume - {{ config.extra.author }}{% endblock %}

{% block content %}
<section class="page-header">
    <div class="container">
        <h1>Resume</h1>
        <p>Professional Experience & Qualifications</p>
    </div>
</section>

<section class="cv-content">
    {% if section.content %}
    <div class="cv-section">
        {{ section.content | safe }}
    </div>
    {% endif %}

    {% if section.extra.experience %}
    <div class="cv-section">
        <h2>Professional Experience</h2>
        
        {% set_global current_company = "" %}
        {% set_global company_roles = [] %}
        
        {% for job in section.extra.experience %}
            {% if job.company != current_company %}
                <!-- Output previous company group if exists -->
                {% if company_roles | length > 0 %}
                    <div class="cv-entry">
                        <div class="cv-company-header">
                            <h3>{{ company_roles[0].company }}</h3>
                            {% if company_roles[0].location %}<span class="cv-location">{{ company_roles[0].location }}</span>{% endif %}
                        </div>
                        {% for role in company_roles %}
                        <div class="cv-role">
                            <div class="cv-role-header">
                                <h4>{{ role.title }}</h4>
                                <span class="cv-date">{{ role.date }}</span>
                            </div>
                            {% if role.points %}
                            <ul>
                                {% for point in role.points %}
                                <li>{{ point }}</li>
                                {% endfor %}
                            </ul>
                            {% endif %}
                        </div>
                        {% endfor %}
                    </div>
                {% endif %}
                <!-- Start new company group -->
                {% set_global current_company = job.company %}
                {% set_global company_roles = [job] %}
            {% else %}
                <!-- Add to current company group -->
                {% set_global company_roles = company_roles | concat(with=job) %}
            {% endif %}
        {% endfor %}
        
        <!-- Output last company group -->
        {% if company_roles | length > 0 %}
            <div class="cv-entry">
                <div class="cv-company-header">
                    <h3>{{ company_roles[0].company }}</h3>
                    {% if company_roles[0].location %}<span class="cv-location">{{ company_roles[0].location }}</span>{% endif %}
                </div>
                {% for role in company_roles %}
                <div class="cv-role">
                    <div class="cv-role-header">
                        <h4>{{ role.title }}</h4>
                        <span class="cv-date">{{ role.date }}</span>
                    </div>
                    {% if role.points %}
                    <ul>
                        {% for point in role.points %}
                        <li>{{ point }}</li>
                        {% endfor %}
                    </ul>
                    {% endif %}
                </div>
                {% endfor %}
            </div>
        {% endif %}
    </div>
    {% endif %}

    {% if section.extra.education %}
    <div class="cv-section">
        <h2>Education</h2>
        
        {% for edu in section.extra.education %}
        <div class="cv-entry">
            <div class="cv-header">
                <h3>{{ edu.degree }}</h3>
                <span class="cv-date">{{ edu.date }}</span>
            </div>
            <h4>{{ edu.school }}</h4>
            {% if edu.details %}
            <p>{{ edu.details }}</p>
            {% endif %}
        </div>
        {% endfor %}
    </div>
    {% endif %}

    {% if section.extra.skills %}
    <div class="cv-section">
        <h2>Technical Skills</h2>
        
        <div class="skills-grid">
            {% for skill in section.extra.skills %}
            <div class="skill-category">
                <h4>{{ skill.category }}</h4>
                <p>{{ skill.items | join(sep=", ") }}</p>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}

    {% if section.extra.certifications %}
    <div class="cv-section">
        <h2>Certifications</h2>
        <ul>
            {% for cert in section.extra.certifications %}
            <li>{{ cert.name }}{% if cert.organization %} - {{ cert.organization }}{% endif %}{% if cert.date %} ({{ cert.date }}){% endif %}</li>
            {% endfor %}
        </ul>
    </div>
    {% endif %}

    {% if section.extra.pdf_link %}
    <div class="cv-download">
        <a href="{{ section.extra.pdf_link }}" class="btn btn-primary">Download PDF Version</a>
    </div>
    {% endif %}
</section>
{% endblock %}